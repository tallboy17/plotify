{"version":3,"file":"request.js","names":["process","browser","env","ENVIRONMENT","versions","electron","type","XMLHttpRequest","module","exports","options","cb","xhr","open","url","responseType","addEventListener","status","data","Buffer","from","response","error","Error","message","e","send","p","require","allOptions","compression","err","res","body"],"sources":["../src/request.js"],"sourcesContent":["/* global XMLHttpRequest */\n\nif (\n  process.browser ||\n  process.env.ENVIRONMENT === \"BROWSER\" ||\n  (typeof process.versions.electron !== \"undefined\" &&\n    process.type === \"renderer\" &&\n    typeof XMLHttpRequest === \"function\")\n) {\n  // If we run into a browser or the electron renderer process,\n  // use XHR method instead of Request node module.\n\n  module.exports = function (options, cb) {\n    const xhr = new XMLHttpRequest();\n    xhr.open(\"GET\", options.url, true);\n    xhr.responseType = \"arraybuffer\";\n    xhr.addEventListener(\"load\", function () {\n      if (xhr.status < 400) {\n        try {\n          const data = Buffer.from(this.response);\n          cb(null, xhr, data);\n        } catch (error) {\n          return cb(\n            new Error(\n              \"Response is not a buffer for url \" +\n                options.url +\n                \". Error: \" +\n                error.message\n            )\n          );\n        }\n      } else {\n        cb(new Error(\"HTTP Status \" + xhr.status + \" for url \" + options.url));\n      }\n    });\n    xhr.addEventListener(\"error\", (e) => {\n      cb(e);\n    });\n    xhr.send();\n  };\n} else {\n  module.exports = function ({ ...options }, cb) {\n    const p = require(\"phin\");\n    const allOptions = { compression: true, ...options };\n\n    try {\n      p(allOptions, (err, res) => {\n        if (err) {\n          cb(err);\n        } else {\n          cb(null, res, res.body);\n        }\n      });\n    } catch (error) {\n      cb(error);\n    }\n  };\n}\n"],"mappings":";;AAAA;;AAEA,IACEA,OAAO,CAACC,OAAO,IACfD,OAAO,CAACE,GAAG,CAACC,WAAW,KAAK,SAAS,IACpC,OAAOH,OAAO,CAACI,QAAQ,CAACC,QAAQ,KAAK,WAAW,IAC/CL,OAAO,CAACM,IAAI,KAAK,UAAU,IAC3B,OAAOC,cAAc,KAAK,UAAW,EACvC;EACA;EACA;;EAEAC,MAAM,CAACC,OAAO,GAAG,UAAUC,OAAO,EAAEC,EAAE,EAAE;IACtC,MAAMC,GAAG,GAAG,IAAIL,cAAc,EAAE;IAChCK,GAAG,CAACC,IAAI,CAAC,KAAK,EAAEH,OAAO,CAACI,GAAG,EAAE,IAAI,CAAC;IAClCF,GAAG,CAACG,YAAY,GAAG,aAAa;IAChCH,GAAG,CAACI,gBAAgB,CAAC,MAAM,EAAE,YAAY;MACvC,IAAIJ,GAAG,CAACK,MAAM,GAAG,GAAG,EAAE;QACpB,IAAI;UACF,MAAMC,IAAI,GAAGC,MAAM,CAACC,IAAI,CAAC,IAAI,CAACC,QAAQ,CAAC;UACvCV,EAAE,CAAC,IAAI,EAAEC,GAAG,EAAEM,IAAI,CAAC;QACrB,CAAC,CAAC,OAAOI,KAAK,EAAE;UACd,OAAOX,EAAE,CACP,IAAIY,KAAK,CACP,mCAAmC,GACjCb,OAAO,CAACI,GAAG,GACX,WAAW,GACXQ,KAAK,CAACE,OAAO,CAChB,CACF;QACH;MACF,CAAC,MAAM;QACLb,EAAE,CAAC,IAAIY,KAAK,CAAC,cAAc,GAAGX,GAAG,CAACK,MAAM,GAAG,WAAW,GAAGP,OAAO,CAACI,GAAG,CAAC,CAAC;MACxE;IACF,CAAC,CAAC;IACFF,GAAG,CAACI,gBAAgB,CAAC,OAAO,EAAGS,CAAC,IAAK;MACnCd,EAAE,CAACc,CAAC,CAAC;IACP,CAAC,CAAC;IACFb,GAAG,CAACc,IAAI,EAAE;EACZ,CAAC;AACH,CAAC,MAAM;EACLlB,MAAM,CAACC,OAAO,GAAG,gBAA0BE,EAAE,EAAE;IAAA,IAApB;MAAE,GAAGD;IAAQ,CAAC;IACvC,MAAMiB,CAAC,GAAGC,OAAO,CAAC,MAAM,CAAC;IACzB,MAAMC,UAAU,GAAG;MAAEC,WAAW,EAAE,IAAI;MAAE,GAAGpB;IAAQ,CAAC;IAEpD,IAAI;MACFiB,CAAC,CAACE,UAAU,EAAE,CAACE,GAAG,EAAEC,GAAG,KAAK;QAC1B,IAAID,GAAG,EAAE;UACPpB,EAAE,CAACoB,GAAG,CAAC;QACT,CAAC,MAAM;UACLpB,EAAE,CAAC,IAAI,EAAEqB,GAAG,EAAEA,GAAG,CAACC,IAAI,CAAC;QACzB;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOX,KAAK,EAAE;MACdX,EAAE,CAACW,KAAK,CAAC;IACX;EACF,CAAC;AACH"}